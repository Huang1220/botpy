# 事件监听

**本文档概述[botpy的事件监听](https://github.com/tencent-connect/botpy/blob/feature/botpy_1.0/botpy/flags.py)**

## 目录
- [准备](#准备)
- [使用方式](#使用方式)
- [监听的事件](#监听的事件)
  + [公域消息事件的监听](#公域消息事件的监听)
  + [消息事件的监听](#消息事件的监听)


## 准备
```python
import botpy
```

## 使用方式

通过继承实现`bot.Client`, 实现自己的机器人Client

在`MyClient`类中调用函数实现处理事件的功能

```python
class MyClient(botpy.Client):
```

## 监听的事件

### 公域消息事件的监听

首先需要订阅事件`public_guild_messages`

```python
intents = botpy.Intents(public_guild_messages=True) 
client = MyClient(intents=intents)
```

|对应函数| 说明 |
| --------- | ---- |
| on_at_message_create(self, message: Message) | 当收到@机器人的消息时 |
| on_public_message_delete(self, message: Message) | 当频道的消息被删除时 |

```python
class MyClient(botpy.Client):
    async def on_at_message_create(self, message: Message):
        """
        此处为处理该事件的代码
        """
    async def on_public_message_delete(self, message: Message):
        """
        此处为处理该事件的代码
        """
```

### 消息事件的监听


- **仅 私域 机器人能够设置此 intents**


首先需要订阅事件`guild_messages`

```python
intents = botpy.Intents(guild_messages=True) 
client = MyClient(intents=intents)
```

|对应函数| 说明 |
| --------- | ---- |
| on_message_create(self, message: Message) | 发送消息事件，代表频道内的全部消息，而不只是 at 机器人的消息。</br>内容与 AT_MESSAGE_CREATE 相同 |
| on_message_delete(self, message: Message) | 删除（撤回）消息事件 |

```python
class MyClient(botpy.Client):
    async def on_message_create(self, message: Message):
        """
        此处为处理该事件的代码
        """
    async def on_message_delete(self, message: Message):
        """
        此处为处理该事件的代码
        """
```
